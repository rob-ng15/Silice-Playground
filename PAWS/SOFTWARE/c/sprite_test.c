#include "PAWSlibrary.h"

// ASTEROIDS BITMAP AS AN EXAMPLE
unsigned short asteroid_bitmap[] = {
    0x07f0, 0x0ff8, 0x1ffe, 0x1fff, 0x3fff, 0xffff, 0xfffe, 0xfffc,
    0xffff, 0x7fff, 0x7fff, 0x7ffe, 0x3ffc, 0x3ffc, 0x0ff8, 0x00f0,
    0x1008, 0x3c1c, 0x7f1e, 0xffff, 0x7ffe, 0x7ffe, 0x3ff8, 0x3ff0,
    0x1ff8, 0x0ff8, 0x1ffc, 0x7ffe, 0xffff, 0x7ffe, 0x3dfc, 0x1878,
    0x0787, 0x1f8e, 0x0fde, 0x67fc, 0xfffc, 0xfffe, 0xffff, 0x7fff,
    0x7ffc, 0x3ff8, 0x3ffc, 0x7ffe, 0xffff, 0xfffe, 0x3ffc, 0x73f8,
    0x1800, 0x3f98, 0x3ffc, 0x1ffe, 0x1ffe, 0x1ffe, 0x7ffe, 0xffff,
    0xffff, 0xffff, 0xfffe, 0xfffe, 0x3ffc, 0x1ff0, 0x07c0, 0x0180,
    0x0ff0, 0x1ffc, 0x1ffe, 0x3ffe, 0x3fff, 0x7fff, 0x7fff, 0xffff,
    0xffff, 0xfffe, 0xfffc, 0x7ffc, 0x3ffc, 0x3ff0, 0x3ff0, 0x07e0,
    0x0000, 0x0000, 0x0000, 0x0180, 0x03c0, 0x03e0, 0x07f8, 0x07fc,
    0x0ffc, 0x1ffc, 0x1ff8, 0x0ff8, 0x01f0, 0x0000, 0x0000, 0x0000,
    0x0600, 0x0fe0, 0x1ff8, 0x3ffc, 0x7ffe, 0xfffe, 0x0fff, 0x1fff,
    0x1fff, 0x3fff, 0x7fff, 0x7ffe, 0x3e7c, 0x3c38, 0x3800, 0x3000,
    0x0020, 0x4206, 0x0006, 0x1820, 0x1800, 0x0081, 0x0400, 0x4010,
    0x0000, 0x0300, 0x0302, 0x6010, 0x6000, 0x0000, 0x0419, 0x8018
};

int main( void ) {
    INITIALISEMEMORY();

    for( short i = 0; i < 16; i++ ) {
        set_sprite_bitmaps( LOWER_LAYER, i, &asteroid_bitmap[0] );
        set_sprite( 0, i, 1, i + 1, i * 40, 16, 0, 0 );
        set_sprite_bitmaps( UPPER_LAYER, i, &asteroid_bitmap[0] );
        set_sprite( 1, i, 1, i + 1, i * 40, 32, 0, 0 );
    }

    gpu_rectangle( BLUE, 110, 70, 210, 170 );

    while(1) {
        await_vblank();

        tpu_set( 1, 29, TRANSPARENT, YELLOW ); tpu_printf( "SPRITES : %04x LAYERS :  %04x ",
            get_sprite_collision( LOWER_LAYER, 0 ),
            get_sprite_layer_collision( LOWER_LAYER, 0 ) );

        // LEFT
        if( ( get_buttons() & 32 ) != 0 )
            update_sprite( LOWER_LAYER, 0, 0b0000000011111 );
        // RIGHT
        if( ( get_buttons() & 64 ) != 0 )
            update_sprite( LOWER_LAYER, 0, 0b0000000000001 );
        // UP
        if( ( get_buttons() & 8 ) != 0 )
            update_sprite( LOWER_LAYER, 0, 0b0001111100000 );
        // DOWN
        if( ( get_buttons() & 16 ) != 0 )
            update_sprite( LOWER_LAYER, 0, 0b0000000100000 );
    }
}
